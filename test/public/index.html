<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ControlID - Ejecutar comandos</title>
</head>
<link rel="stylesheet" href="styles.css">
</head>
</head>
<body>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h2>ControlID - Ejecutar comandos</h2>
        <div class="small muted">Selecciona dispositivo y comando; los parámetros se cargarán automáticamente.</div>
      </div>
      <div class="controls">
        <div class="label-inline">Sesiones activas:</div>
        <div id="sessionIndicator" class="small muted">cargando...</div>
        <button id="configMonitor" class="btn-link">Config Monitor</button>
        <button id="manageDevices" class="btn-link">Gestionar dispositivos</button>
      </div>
    </div>

    <div class="card">
      <div class="row">
        <div class="col">
          <label for="device">Dispositivo</label>
          <select id="device"></select>
        </div>
        <div style="width:260px">
          <label for="command">Comando</label>
          <select id="command"></select>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <div id="params" class="params-grid"></div>
        <div style="margin-top:12px; display:flex; gap:8px; justify-content:flex-end">
          <button id="execute">Ejecutar</button>
          <button id="clearResponse" class="secondary">Limpiar</button>
        </div>
      </div>

      <div class="row" style="margin-top:12px">
        <div class="col">
          <h3>Respuesta</h3>
          <div id="response" class="response">Ninguna ejecución aún.</div>
        </div>
        <div style="width:320px">
          <h3>Historial</h3>
          <div id="history" class="history card small"></div>
        </div>
      </div>
    </div>

    <!-- modal device manager -->
    <div id="deviceManager" class="modal" style="display:none">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3>Gestionar dispositivos</h3>
          <div><button id="closeManager">Cerrar</button></div>
        </div>
        <div id="devicesList"></div>
        <hr />
        <h4 id="deviceFormTitle">Añadir dispositivo</h4>
        <div class="row">
          <div class="col"><label>Nombre</label><input id="new_name" /></div>
          <div class="col"><label>IP</label><input id="new_ip" /></div>
        </div>
        <div class="row" style="margin-top:8px">
          <div class="col"><label>Login</label><input id="new_login" /></div>
          <div class="col"><label>Password</label><input id="new_password" /></div>
        </div>
        <div id="defaultsArea" style="margin-top:12px"></div>
        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
          <button id="addDevice">Añadir</button>
        </div>
      </div>

        <!-- modal monitor config -->
        <div id="monitorModal" class="modal" style="display:none">
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <h3>Configurar Monitor</h3>
              <div><button id="closeMonitor">Cerrar</button></div>
            </div>
            <div style="margin-top:8px">
              <div class="row">
                <div class="col"><label>Hostname</label><input id="mon_hostname" placeholder="ej: 192.168.0.20 o myserver.com"/></div>
                <div class="col"><label>Port</label><input id="mon_port" type="number" placeholder="8000"/></div>
              </div>
              <div class="row" style="margin-top:8px">
                <div class="col"><label>Path</label><input id="mon_path" placeholder="api/notifications"/></div>
                <div class="col"><label>Request timeout (ms)</label><input id="mon_timeout" type="number" placeholder="5000"/></div>
              </div>
              <div class="row" style="margin-top:8px">
                <div class="col"><label>Alive interval (ms)</label><input id="mon_alive" type="number" placeholder="30000"/></div>
                <div class="col"><label>Enable photo upload</label><select id="mon_photo"><option value="0">No</option><option value="1">Sí</option></select></div>
              </div>
              <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
                <button id="saveMonitor">Guardar en el dispositivo</button>
                <button id="saveMonitorDefaults" class="secondary">Guardar defaults</button>
              </div>
            </div>
          </div>
        </div>
    </div>

    <script src="app.js"></script>
  </div>
</body>
</html>
